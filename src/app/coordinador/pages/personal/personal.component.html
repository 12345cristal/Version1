<div class="personal-wrapper">

  <!-- ========================================================= -->
  <!-- üîπ HEADER SUPERIOR                                         -->
  <!-- ========================================================= -->
  <header class="page-header">

    <div class="page-title">
      <div class="page-title-row">
        <h1>Gesti√≥n de Personal</h1>
      </div>
      <p class="page-subtitle">
        Administra el equipo terap√©utico y personal del centro.
      </p>
    </div>

    <button class="btn-new" (click)="openAddForm()">
      <mat-icon>person_add</mat-icon>
      <span>Agregar personal</span>
    </button>

  </header>


  <!-- ========================================================= -->
  <!-- üîπ TARJETAS DE ESTAD√çSTICAS                                -->
  <!-- ========================================================= -->
  <section class="stats-row">

    <article class="stat-card total">
      <div class="stat-icon"><mat-icon>supervisor_account</mat-icon></div>
      <div class="stat-info">
        <span class="stat-label">Total personal</span>
        <span class="stat-value">{{ totalPersonal }}</span>
      </div>
    </article>

    <article class="stat-card terapeutas">
      <div class="stat-icon"><mat-icon>psychology</mat-icon></div>
      <div class="stat-info">
        <span class="stat-label">Terapeutas</span>
        <span class="stat-value">{{ totalTerapeutas }}</span>
      </div>
    </article>

    <article class="stat-card activos">
      <div class="stat-icon"><mat-icon>task_alt</mat-icon></div>
      <div class="stat-info">
        <span class="stat-label">Personal activo</span>
        <span class="stat-value">{{ totalActivos }}</span>
      </div>
    </article>

    <article class="stat-card rating">
      <div class="stat-icon"><mat-icon>star</mat-icon></div>
      <div class="stat-info">
        <span class="stat-label">Calificaci√≥n promedio</span>
        <span class="stat-value">
          @if (calificacionPromedio !== null) {
            {{ calificacionPromedio | number:'1.1-1' }}
          } @else {
            ‚Äî
          }
        </span>
      </div>
    </article>

  </section>



  <!-- ========================================================= -->
  <!-- üîπ FILTROS (SEARCH + ROL + ESTADO en una sola l√≠nea)       -->
  <!-- ========================================================= -->
  <section class="filters-bar">

    <!-- üîç BUSCADOR -->
    <mat-form-field class="search-field" appearance="outline">
      <mat-icon matPrefix>search</mat-icon>
      <input
        matInput
        placeholder="Buscar por nombre o especialidad‚Ä¶"
        [value]="search"
        (input)="onSearch($any($event.target).value)" />
    </mat-form-field>

    <!-- üîΩ ROL -->
    <mat-form-field class="filter-field" appearance="outline">
      <mat-label>Rol</mat-label>
      <mat-select
        [value]="selectedRole"
        (selectionChange)="onRoleSelect($event.value)">
        <mat-option value="">Todos los roles</mat-option>
        @for (r of roles; track r) {
          <mat-option [value]="r">{{ r }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <!-- üîΩ ESTADO -->
    <mat-form-field class="filter-field" appearance="outline">
      <mat-label>Estado</mat-label>
      <mat-select
        [value]="selectedEstado"
        (selectionChange)="onEstadoSelect($event.value)">
        <mat-option value="Todos">Todos</mat-option>
        <mat-option value="Activo">Activos</mat-option>
        <mat-option value="Inactivo">Inactivos</mat-option>
      </mat-select>
    </mat-form-field>

  </section>



  <!-- ========================================================= -->
  <!-- üîπ VIEW SWITCH (Tarjetas / Tabla / Horarios)               -->
  <!-- ========================================================= -->
  <div class="view-switch-row">
    <button class="view-chip" [class.active]="view === 'cards'" (click)="setView('cards')">
      <mat-icon>dashboard</mat-icon>
      <span>Tarjetas</span>
    </button>

    <button class="view-chip" [class.active]="view === 'table'" (click)="setView('table')">
      <mat-icon>table_chart</mat-icon>
      <span>Tabla</span>
    </button>

    <button class="view-chip" [class.active]="view === 'horarios'" (click)="setView('horarios')">
      <mat-icon>calendar_month</mat-icon>
      <span>Horarios</span>
    </button>
  </div>

</div>
